from django.core.management.utils import get_random_secret_key
import shutil, os

TARGET_APP_FILE = "docker/app/.env"
TARGET_APP_TEMP_FILE = "docker/app/.env.example"
TARGET_DB_FILE = "docker/db/.env"
TARGET_DB_TEMP_FILE = "docker/db/.env.example"
TARGET_WORD = "[DjangoSecretKey]"
SECRET_KEY = get_random_secret_key()

shutil.copy(TARGET_APP_TEMP_FILE, TARGET_APP_FILE)
shutil.copy(TARGET_DB_TEMP_FILE, TARGET_DB_FILE)

with open(TARGET_APP_FILE, 'r') as file:
  filedata = file.read()

filedata = filedata.replace(TARGET_WORD, SECRET_KEY)

with open(TARGET_APP_FILE, 'w') as file:
  file.write(filedata)

shutil.rmtree('docker/setup')
os.remove('project_setup.py')
